---
title: "Confounding Simulations"
author: "Eleanor Sanderson"
date: "03/08/2022"
output: 
  pdf_document: 
    keep_tex: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Note;
Files should be saved as results_A.Rda etc before running this file. If results are still in the output given by the BC4 array job run 'combiningfiles.R' first.

```{r, include=FALSE}
library(tidyverse)
library(ggplot2)
```

\section{Model A}

```{r}
load('results_confA.Rda')

```

Description of parameters for model A 

\textit{
snps = 200       no of SNPs for X1
snpsc = 200         No of SNPs for X2/X3
nobs = 100000
beta3 = 0
gamma31 = 0
}

\subsection{Generate figure A.1}

```{r}

resa_mean <- res_a %>%
  select(-model) %>%
  group_by(pvalue) %>%
  summarise_all(mean)

resa_fig1 <- resa_mean %>%
  select(c(pvalue, beta_ivw, se_ivw)) 

colnames(resa_fig1) <- c('pvalue', 'beta', 'se')
resa_fig1$Estimator <- "IVW"


resa_egger <- resa_mean %>%
  select(c(pvalue, beta_egger, se_egger)) 
colnames(resa_egger) <- c('pvalue', 'beta', 'se')
resa_egger$Estimator <- "MR Egger"

resa_med <- resa_mean %>%
  select(c(pvalue, beta_med, se_med)) 
colnames(resa_med) <- c('pvalue', 'beta', 'se')
resa_med$Estimator <- "W. Median"

resa_mode <- resa_mean %>%
  select(c(pvalue, beta_mode, se_mode)) 
colnames(resa_mode) <- c('pvalue', 'beta', 'se')
resa_mode$Estimator <- "W. Mode"

resa_mvmr <- resa_mean %>%
  select(c(pvalue, mvmr.X1_effect, mvmr.X1_se)) 
colnames(resa_mvmr) <- c('pvalue', 'beta', 'se')
resa_mvmr$Estimator <- "MVMR"


resa_fig1 <- bind_rows(resa_fig1, resa_egger, resa_med, resa_mode, resa_mvmr)
resa_fig1$Estimator <- as.factor(resa_fig1$Estimator)
resa_fig1$Estimator <- factor(resa_fig1$Estimator, levels = c("IVW", "MR Egger", "W. Median", "W. Mode", "MVMR"))

plot1 <- ggplot(resa_fig1, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
  ylim(-0.4, 0.2) +
  scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfA1.pdf", width = 6.5, height = 5)

```
Generate results table

```{r}

tablea1 <- resa_mean %>%
  select(c(pvalue, beta_ivw, se_ivw, beta_egger, se_egger, beta_med, se_med, beta_mode, se_mode, mvmr.X1_effect, mvmr.X1_se)) 
  
tablea1$NSNPS <- 200

```

\subsection{Generate figure A.2 - with steiger filtering applied}

```{r}

resa_fig2 <- resa_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s)) 

colnames(resa_fig2) <- c('pvalue', 'beta', 'se')
resa_fig2$Estimator <- "IVW"


resa_egger <- resa_mean %>%
  select(c(pvalue, beta_egger.s, se_egger.s)) 
colnames(resa_egger) <- c('pvalue', 'beta', 'se')
resa_egger$Estimator <- "MR Egger"

resa_med <- resa_mean %>%
  select(c(pvalue, beta_med.s, se_med.s)) 
colnames(resa_med) <- c('pvalue', 'beta', 'se')
resa_med$Estimator <- "W. Median"

resa_mode <- resa_mean %>%
  select(c(pvalue, beta_mode.s, se_mode.s)) 
colnames(resa_mode) <- c('pvalue', 'beta', 'se')
resa_mode$Estimator <- "W. Mode"


resa_fig2 <- bind_rows(resa_fig2, resa_egger, resa_med, resa_mode)


plot1 <- ggplot(resa_fig2, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
   ylim(-0.4, 0.2) +
  scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfA2.pdf")

```

Generate results table

```{r}

tablea1s <- resa_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s, beta_egger.s, se_egger.s, beta_med.s, se_med.s, beta_mode.s, se_mode.s)) 
  
tablea1s$NSNPS <- 200

```
\section{Model B}

```{r}
load('results_confB.Rda')

```

Description of parameters for model B 

\textit{   
    snps = 150       no of SNPs for X1
    snpsc = 250         No of SNPs for X2/X3
    nobs = 100000
    beta3 = 0
    gamma31 = 0
}
    
\subsection{Plot the distribution of the estimated parameters}

```{r}

resb_12 <- filter(res_b, pvalue==5e-12)

ggplot(resb_12, aes(x=beta_mode)) +
 geom_density(kernel = "gaussian") 
 
ggplot(resb_12, aes(x=beta_ivw)) +
 geom_density(kernel = "gaussian") 

```

\subsection{Generate figure B.1}

```{r}

resb_mean <- res_b %>%
  select(-model) %>%
  group_by(pvalue) %>%
  summarise_all(mean)


resb_fig1 <- resb_mean %>%
  select(c(pvalue, beta_ivw, se_ivw)) 

colnames(resb_fig1) <- c('pvalue', 'beta', 'se')
resb_fig1$Estimator <- "IVW"


resb_egger <- resb_mean %>%
  select(c(pvalue, beta_egger, se_egger)) 
colnames(resb_egger) <- c('pvalue', 'beta', 'se')
resb_egger$Estimator <- "MR Egger"

resb_med <- resb_mean %>%
  select(c(pvalue, beta_med, se_med)) 
colnames(resb_med) <- c('pvalue', 'beta', 'se')
resb_med$Estimator <- "W. Median"

resb_mode <- resb_mean %>%
  select(c(pvalue, beta_mode, se_mode)) 
colnames(resb_mode) <- c('pvalue', 'beta', 'se')
resb_mode$Estimator <- "W. Mode"

resb_mvmr <- resb_mean %>%
  select(c(pvalue, mvmr.X1_effect, mvmr.X1_se)) 
colnames(resb_mvmr) <- c('pvalue', 'beta', 'se')
resb_mvmr$Estimator <- "MVMR"


resb_fig1 <- bind_rows(resb_fig1, resb_egger, resb_med, resb_mode, resb_mvmr)
resb_fig1$Estimator <- as.factor(resb_fig1$Estimator)
resb_fig1$Estimator <- factor(resb_fig1$Estimator, levels = c("IVW", "MR Egger", "W. Median", "W. Mode", "MVMR"))

plot1 <- ggplot(resb_fig1, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
  scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfB1.pdf")

```

Generate results table

```{r}

tableb1 <- resb_mean %>%
  select(c(pvalue, beta_ivw, se_ivw, beta_egger, se_egger, beta_med, se_med, beta_mode, se_mode, mvmr.X1_effect, mvmr.X1_se)) 
  
tableb1$NSNPS <- 250

```


\subsection{Generate figure B.2 - with steiger filtering applied}

```{r}

resb_fig2 <- resb_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s)) 

colnames(resb_fig2) <- c('pvalue', 'beta', 'se')
resb_fig2$Estimator <- "IVW"


resb_egger <- resb_mean %>%
  select(c(pvalue, beta_egger.s, se_egger.s)) 
colnames(resb_egger) <- c('pvalue', 'beta', 'se')
resb_egger$Estimator <- "MR Egger"

resb_med <- resb_mean %>%
  select(c(pvalue, beta_med.s, se_med.s)) 
colnames(resb_med) <- c('pvalue', 'beta', 'se')
resb_med$Estimator <- "W. Median"

resb_mode <- resb_mean %>%
  select(c(pvalue, beta_mode.s, se_mode.s)) 
colnames(resb_mode) <- c('pvalue', 'beta', 'se')
resb_mode$Estimator <- "W. Mode"


resb_fig2 <- bind_rows(resb_fig2, resb_egger, resb_med, resb_mode)


plot1 <- ggplot(resb_fig2, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
  scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "right") +
   scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfB2.pdf")

```

Generate results table

```{r}

tableb1s <- resb_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s, beta_egger.s, se_egger.s, beta_med.s, se_med.s, beta_mode.s, se_mode.s)) 
  
tableb1s$NSNPS <- 250

```


\section{Model C}

```{r}
load('results_confC.Rda')

```

Description of parameters for model C 

\textit{
     snps = 100       no of SNPs for X1
    snpsc = 300       No of SNPs for X2/X3
    nobs = 100000
    beta3 = 0
    gamma31 = 0}
    
\subsection{Generate figure C.1}

```{r}

resc_mean <- res_c %>%
  select(-model) %>%
  group_by(pvalue) %>%
  summarise_all(mean)


resc_fig1 <- resc_mean %>%
  select(c(pvalue, beta_ivw, se_ivw)) 

colnames(resc_fig1) <- c('pvalue', 'beta', 'se')
resc_fig1$Estimator <- "IVW"


resc_egger <- resc_mean %>%
  select(c(pvalue, beta_egger, se_egger)) 
colnames(resc_egger) <- c('pvalue', 'beta', 'se')
resc_egger$Estimator <- "MR Egger"

resc_med <- resc_mean %>%
  select(c(pvalue, beta_med, se_med)) 
colnames(resc_med) <- c('pvalue', 'beta', 'se')
resc_med$Estimator <- "W. Median"

resc_mode <- resc_mean %>%
  select(c(pvalue, beta_mode, se_mode)) 
colnames(resc_mode) <- c('pvalue', 'beta', 'se')
resc_mode$Estimator <- "W. Mode"

resc_mvmr <- resc_mean %>%
  select(c(pvalue, mvmr.X1_effect, mvmr.X1_se)) 
colnames(resc_mvmr) <- c('pvalue', 'beta', 'se')
resc_mvmr$Estimator <- "MVMR"


resc_fig1 <- bind_rows(resc_fig1, resc_egger, resc_med, resc_mode, resc_mvmr)
resc_fig1$Estimator <- as.factor(resc_fig1$Estimator)
resc_fig1$Estimator <- factor(resc_fig1$Estimator, levels = c("IVW", "MR Egger", "W. Median", "W. Mode", "MVMR"))

plot1 <- ggplot(resc_fig1, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
    scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfC1.pdf")

```

Generate results table

```{r}

tablec1 <- resc_mean %>%
  select(c(pvalue, beta_ivw, se_ivw, beta_egger, se_egger, beta_med, se_med, beta_mode, se_mode, mvmr.X1_effect, mvmr.X1_se)) 
  
tablec1$NSNPS <- 300

```


\subsection{Generate figure C.2}

```{r}

resc_mean <- res_c %>%
  select(-model) %>%
  group_by(pvalue) %>%
  summarise_all(mean)


resc_fig2 <- resc_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s)) 

colnames(resc_fig2) <- c('pvalue', 'beta', 'se')
resc_fig2$Estimator <- "IVW"


resc_egger <- resc_mean %>%
  select(c(pvalue, beta_egger.s, se_egger.s)) 
colnames(resc_egger) <- c('pvalue', 'beta', 'se')
resc_egger$Estimator <- "MR Egger"

resc_med <- resc_mean %>%
  select(c(pvalue, beta_med.s, se_med.s)) 
colnames(resc_med) <- c('pvalue', 'beta', 'se')
resc_med$Estimator <- "W. Median"

resc_mode <- resc_mean %>%
  select(c(pvalue, beta_mode.s, se_mode.s)) 
colnames(resc_mode) <- c('pvalue', 'beta', 'se')
resc_mode$Estimator <- "W. Mode"


resc_fig2 <- bind_rows(resc_fig2, resc_egger, resc_med, resc_mode)
resc_fig2$Estimator <- as.factor(resc_fig2$Estimator)
resc_fig2$Estimator <- factor(resc_fig2$Estimator, levels = c("IVW", "MR Egger", "W. Median", "W. Mode"))

plot1 <- ggplot(resc_fig2, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
    scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfC2.pdf")

```

Generate results table

```{r}

tablec1s <- resc_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s, beta_egger.s, se_egger.s, beta_med.s, se_med.s, beta_mode.s, se_mode.s)) 
  
tablec1s$NSNPS <- 300

```

\section{Model D}

```{r}
load('results_confD.Rda')

```

Description of parameters for model D 

\textit{
snps = 50       no of SNPs for X1
snpsc = 350         No of SNPs for X2/X3
nobs = 100000
beta3 = 0
gamma31 = 0
}

\subsection{Generate figure D.1}

```{r}

resd_mean <- res_d %>%
  select(-model) %>%
  group_by(pvalue) %>%
  summarise_all(mean)

resd_fig1 <- resd_mean %>%
  select(c(pvalue, beta_ivw, se_ivw)) 

colnames(resd_fig1) <- c('pvalue', 'beta', 'se')
resd_fig1$Estimator <- "IVW"


resd_egger <- resd_mean %>%
  select(c(pvalue, beta_egger, se_egger)) 
colnames(resd_egger) <- c('pvalue', 'beta', 'se')
resd_egger$Estimator <- "MR Egger"

resd_med <- resd_mean %>%
  select(c(pvalue, beta_med, se_med)) 
colnames(resd_med) <- c('pvalue', 'beta', 'se')
resd_med$Estimator <- "W. Median"

resd_mode <- resd_mean %>%
  select(c(pvalue, beta_mode, se_mode)) 
colnames(resd_mode) <- c('pvalue', 'beta', 'se')
resd_mode$Estimator <- "W. Mode"

resd_mvmr <- resd_mean %>%
  select(c(pvalue, mvmr.X1_effect, mvmr.X1_se)) 
colnames(resd_mvmr) <- c('pvalue', 'beta', 'se')
resd_mvmr$Estimator <- "MVMR"


resd_fig1 <- bind_rows(resd_fig1, resd_egger, resd_med, resd_mode, resd_mvmr)
resd_fig1$Estimator <- as.factor(resd_fig1$Estimator)
resd_fig1$Estimator <- factor(resd_fig1$Estimator, levels = c("IVW", "MR Egger", "W. Median", "W. Mode", "MVMR"))

plot1 <- ggplot(resd_fig1, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
   scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfD1.pdf")

```

Generate results table

```{r}

tabled1 <- resd_mean %>%
  select(c(pvalue, beta_ivw, se_ivw, beta_egger, se_egger, beta_med, se_med, beta_mode, se_mode, mvmr.X1_effect, mvmr.X1_se)) 
  
tabled1$NSNPS <- 350

```


\subsection{Generate figure D.2}

```{r}


resd_fig2 <- resd_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s)) 

colnames(resd_fig2) <- c('pvalue', 'beta', 'se')
resd_fig2$Estimator <- "IVW"


resd_egger <- resd_mean %>%
  select(c(pvalue, beta_egger.s, se_egger.s)) 
colnames(resd_egger) <- c('pvalue', 'beta', 'se')
resd_egger$Estimator <- "MR Egger"

resd_med <- resd_mean %>%
  select(c(pvalue, beta_med.s, se_med.s)) 
colnames(resd_med) <- c('pvalue', 'beta', 'se')
resd_med$Estimator <- "W. Median"

resd_mode <- resd_mean %>%
  select(c(pvalue, beta_mode.s, se_mode.s)) 
colnames(resd_mode) <- c('pvalue', 'beta', 'se')
resd_mode$Estimator <- "W. Mode"


resd_fig2 <- bind_rows(resd_fig2, resd_egger, resd_med, resd_mode, resd_mvmr)
resd_fig2$Estimator <- as.factor(resd_fig2$Estimator)
resd_fig2$Estimator <- factor(resd_fig2$Estimator, levels = c("IVW", "MR Egger", "W. Median", "W. Mode"))

plot1 <- ggplot(resd_fig2, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
   scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfD2.pdf")

```
Generate results table

```{r}

tabled1s <- resd_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s, beta_egger.s, se_egger.s, beta_med.s, se_med.s, beta_mode.s, se_mode.s)) 
  
tabled1s$NSNPS <- 350

```

\section{Model  E}

```{r}
load('results_confE.Rda')

```

Description of parameters for model E 

\textit{
     snps = 10       no of SNPs for X1
    snpsc = 390       No of SNPs for X2/X3
    nobs = 100000
    beta3 = 0
    gamma31 = 0}
    
\subsection{Generate figure E.1}

```{r}

rese_mean <- res_e %>%
  select(-model) %>%
  group_by(pvalue) %>%
  summarise_all(mean)


rese_fig1 <- rese_mean %>%
  select(c(pvalue, beta_ivw, se_ivw)) 

colnames(rese_fig1) <- c('pvalue', 'beta', 'se')
rese_fig1$Estimator <- "IVW"


rese_egger <- rese_mean %>%
  select(c(pvalue, beta_egger, se_egger)) 
colnames(rese_egger) <- c('pvalue', 'beta', 'se')
rese_egger$Estimator <- "MR Egger"

rese_med <- rese_mean %>%
  select(c(pvalue, beta_med, se_med)) 
colnames(rese_med) <- c('pvalue', 'beta', 'se')
rese_med$Estimator <- "W. Median"

rese_mode <- rese_mean %>%
  select(c(pvalue, beta_mode, se_mode)) 
colnames(rese_mode) <- c('pvalue', 'beta', 'se')
rese_mode$Estimator <- "W. Mode"

rese_mvmr <- rese_mean %>%
  select(c(pvalue, mvmr.X1_effect, mvmr.X1_se)) 
colnames(rese_mvmr) <- c('pvalue', 'beta', 'se')
rese_mvmr$Estimator <- "MVMR"


rese_fig1 <- bind_rows(rese_fig1, rese_egger, rese_med, rese_mode, rese_mvmr)
rese_fig1$Estimator <- as.factor(rese_fig1$Estimator)
rese_fig1$Estimator <- factor(rese_fig1$Estimator, levels = c("IVW", "MR Egger", "W. Median", "W. Mode", "MVMR"))

plot1 <- ggplot(rese_fig1, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
   ylim(-0.8, 0.8) +
    scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfE1.pdf", width = 6.5, height = 5)


```

Generate results table

```{r}

tablee1 <- rese_mean %>%
  select(c(pvalue, beta_ivw, se_ivw, beta_egger, se_egger, beta_med, se_med, beta_mode, se_mode, mvmr.X1_effect, mvmr.X1_se)) 
  
tablee1$NSNPS <- 390

```

\subsection{Generate figure E.2}

```{r}

rese_mean <- res_e %>%
  select(-model) %>%
  group_by(pvalue) %>%
  summarise_all(mean, na.rm = TRUE)


rese_fig1 <- rese_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s)) 

colnames(rese_fig1) <- c('pvalue', 'beta', 'se')
rese_fig1$Estimator <- "IVW"


rese_egger <- rese_mean %>%
  select(c(pvalue, beta_egger.s, se_egger.s)) 
colnames(rese_egger) <- c('pvalue', 'beta', 'se')
rese_egger$Estimator <- "MR Egger"

rese_med <- rese_mean %>%
  select(c(pvalue, beta_med.s, se_med.s)) 
colnames(rese_med) <- c('pvalue', 'beta', 'se')
rese_med$Estimator <- "W. Median"

rese_mode <- rese_mean %>%
  select(c(pvalue, beta_mode.s, se_mode.s)) 
colnames(rese_mode) <- c('pvalue', 'beta', 'se')
rese_mode$Estimator <- "W. Mode"



rese_fig2 <- bind_rows(rese_fig1, rese_egger, rese_med, rese_mode)

plot1 <- ggplot(rese_fig2, aes(x=log10(pvalue))) +
  geom_pointrange(aes(y=beta, ymin=(beta - 1.96*se), ymax=(beta + 1.96*se), group=Estimator, colour=Estimator), position=position_dodge(width = 0.5)) +
   ylim(-0.8, 0.8) +
   scale_colour_brewer(palette = "Set1") +
   theme(legend.position = "bottom") +
  labs(x = "Pvalue (log10)", y = "Estimated effect of exposure")

plot1
ggsave("plotconfE2.pdf", width = 6.5, height = 5)


```

Generate results table

```{r}

tablee1s <- rese_mean %>%
  select(c(pvalue, beta_ivw.s, se_ivw.s, beta_egger.s, se_egger.s, beta_med.s, se_med.s, beta_mode.s, se_mode.s)) 
  
tablee1s$NSNPS <- 390

```

Calculating the number of repetitions used for each of the estimators in the plot above

```{r}

res_eforna <- res_e %>% 
  select(pvalue, beta_ivw.s, beta_egger.s, beta_mode.s, beta_med.s)

na04 <- colSums(is.na(subset(res_eforna, pvalue==5e-04))) 
na06 <- colSums(is.na(subset(res_eforna, pvalue==5e-06))) 
na08 <- colSums(is.na(subset(res_eforna, pvalue==5e-08))) 
na12 <- colSums(is.na(subset(res_eforna, pvalue==5e-12))) 


```

Pvalue 5e-04
```{r}
na04
```
Pvalue 5e-06
```{r}
na06
```
Pvalue 5e-08
```{r}
na08
```
Pvalue 5e-12
```{r}
na12
```


Combining the tables and outputting them

```{r}
Table_all <- bind_rows(tablea1, tableb1, tablec1, tabled1, tablee1)
Table_steiger <- bind_rows(tablea1s, tableb1s, tablec1s, tabled1s, tablee1s)

write.csv(Table_all, "simresults_table.csv")
write.csv(Table_steiger, "simresults_steiger.csv")
```

